<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì¬ê³  ê´€ë¦¬</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="d-flex flex-column" style="min-height: 100vh;">

  <!-- âœ… ê³µí†µ ë ˆì´ì•„ì›ƒ -->
  <div id="header"></div>
  <div class="d-flex flex-grow-1">
    <div id="sidebar"></div>
    <main class="p-4 flex-fill">
      <div class="container">
        <h2 class="mb-4">ì¬ê³  ê´€ë¦¬</h2>

        <!-- ğŸ” ê²€ìƒ‰ ë° ë²„íŠ¼ ì˜ì—­ -->
        <div class="d-flex flex-wrap gap-2 align-items-center mb-3">
          <input type="text" class="form-control w-auto" placeholder="í’ˆëª©ëª… or í’ˆëª©ì½”ë“œ" />
          <select class="form-select w-auto">
            <option>ì „ì²´ ì°½ê³ </option>
            <option>ìì¬ì°½ê³ </option>
            <option>ì™„ì œí’ˆì°½ê³ </option>
          </select>
          <button class="btn btn-outline-secondary">ê²€ìƒ‰</button>

          <button class="btn btn-outline-success ms-auto" onclick="alert('ì—‘ì…€ ë‹¤ìš´ë¡œë“œëŠ” ì¶”í›„ ì œê³µ ì˜ˆì •ì…ë‹ˆë‹¤.')">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
        </div>

        <!-- ğŸ“‹ ì¬ê³  í˜„í™© í…Œì´ë¸” -->
        <div class="table-responsive">
          <table class="table table-bordered text-center align-middle">
            <thead class="table-light">
              <tr>
                <th>ìˆœë²ˆ</th>
                <th>í’ˆëª©ì½”ë“œ</th>
                <th>í’ˆëª©ëª…</th>
                <th>ì°½ê³ </th>
                <th>ì¬ê³ ìˆ˜ëŸ‰</th>
                <th>ë‹¨ìœ„</th>
                <th>ìµœì¢…ì…ê³ ì¼</th>
                <th>ìµœì¢…ì¶œê³ ì¼</th>
                <th>ìƒì„¸</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>M001</td>
                <td>ìì¬ A</td>
                <td>ìì¬ì°½ê³ </td>
                <td>320</td>
                <td>EA</td>
                <td>2025-05-19</td>
                <td>2025-05-21</td>
                <td>
                  <button class="btn btn-info btn-sm" onclick="openStockDetailModal({
                    item_code: 'M001',
                    item_name: 'ìì¬ A',
                    warehouse: 'ìì¬ì°½ê³ ',
                    qty: 320,
                    unit: 'EA',
                    last_in: '2025-05-19',
                    last_out: '2025-05-21'
                  })">ìƒì„¸</button>
                </td>
              </tr>
              <tr>
                <td>2</td>
                <td>P001</td>
                <td>ì™„ì œí’ˆ A</td>
                <td>ì™„ì œí’ˆì°½ê³ </td>
                <td>110</td>
                <td>EA</td>
                <td>2025-05-17</td>
                <td>2025-05-20</td>
                <td>
                  <button class="btn btn-info btn-sm" onclick="openStockDetailModal({
                    item_code: 'P001',
                    item_name: 'ì™„ì œí’ˆ A',
                    warehouse: 'ì™„ì œí’ˆì°½ê³ ',
                    qty: 110,
                    unit: 'EA',
                    last_in: '2025-05-17',
                    last_out: '2025-05-20'
                  })">ìƒì„¸</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
  <div id="footer"></div>
  <div id="stockDetailModalWrapper"></div>

  <!-- âœ… ê³µí†µ ì»´í¬ë„ŒíŠ¸ fetch -->
  <script>
    fetch('/layouts/header.html').then(res => res.text()).then(html => document.getElementById('header').innerHTML = html);
    fetch('/layouts/sidebar.html').then(res => res.text()).then(html => document.getElementById('sidebar').innerHTML = html);
    fetch('/layouts/footer.html').then(res => res.text()).then(html => document.getElementById('footer').innerHTML = html);

    // ìƒì„¸ ëª¨ë‹¬ fetch (í˜ì´ì§€ ìµœì´ˆ ì§„ì…ì‹œ)
    fetch('/pages/stock/stock-detail-modal.html')
      .then(res => res.text())
      .then(html => document.getElementById('stockDetailModalWrapper').innerHTML = html);
  </script>

  <!-- âœ… ìƒì„¸ ëª¨ë‹¬ ì—´ê¸° í•¨ìˆ˜ -->
  <script>
    function openStockDetailModal(stock) {
      // ëª¨ë‹¬ì´ ì—†ìœ¼ë©´ fetchí›„ ì¬í˜¸ì¶œ (ì´ì¤‘ì‹¤í–‰ ë°©ì§€)
      if (!document.getElementById('stockDetailModal')) {
        fetch('/pages/stock/stock-detail-modal.html')
          .then(res => res.text())
          .then(html => {
            document.getElementById('stockDetailModalWrapper').innerHTML = html;
            setTimeout(() => openStockDetailModal(stock), 50);
          });
        return;
      }

      // ìƒì„¸ ë°ì´í„° ì±„ìš°ê¸°
      document.getElementById('detailItemCode').textContent = stock.item_code;
      document.getElementById('detailItemName').textContent = stock.item_name;
      document.getElementById('detailWarehouse').textContent = stock.warehouse;
      document.getElementById('detailQty').textContent = stock.qty;
      document.getElementById('detailUnit').textContent = stock.unit;
      document.getElementById('detailLastIn').textContent = stock.last_in;
      document.getElementById('detailLastOut').textContent = stock.last_out;

      // ëª¨ë‹¬ ì—´ê¸°
      const modal = new bootstrap.Modal(document.getElementById('stockDetailModal'));
      modal.show();
    }
  </script>
</body>
</html>
