<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MRP(ìì¬ì†Œìš”ê³„íš) ê´€ë¦¬</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="d-flex flex-column" style="min-height: 100vh;">
  <!-- í—¤ë”/ì‚¬ì´ë“œë°”/í‘¸í„° ë“± ê³µí†µ ë ˆì´ì•„ì›ƒ ì˜ì—­ -->
  <div id="header"></div>
  <div class="d-flex flex-grow-1">
    <div id="sidebar"></div>
    <main class="p-4 flex-fill">
      <div class="container">
        <h2 class="mb-4">MRP(ìì¬ì†Œìš”ê³„íš) ê´€ë¦¬</h2>

        <!-- ğŸ” ê²€ìƒ‰/í•„í„° + ë²„íŠ¼ í•œì¤„ -->
        <div class="d-flex flex-wrap gap-2 align-items-center mb-3">
          <input type="date" class="form-control w-auto" />
          <span>~</span>
          <input type="date" class="form-control w-auto" />
          <input type="text" class="form-control w-auto" placeholder="í’ˆëª©ëª…/ì½”ë“œ" />
          <button class="btn btn-outline-secondary">MRP ê³„ì‚°</button>
          <button class="btn btn-outline-success ms-auto">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
        </div>

        <!-- ğŸ“‹ MRP ê²°ê³¼ í…Œì´ë¸” -->
        <div class="table-responsive">
          <table class="table table-bordered text-center align-middle">
            <thead class="table-light">
              <tr>
                <th>í’ˆëª©ì½”ë“œ</th>
                <th>í’ˆëª©ëª…</th>
                <th>í’ˆëª©ìœ í˜•</th>
                <th>ë‹¨ìœ„</th>
                <th>ê¸°ì¤€ì¼ì</th>
                <th>í•„ìš”ìˆ˜ëŸ‰</th>
                <th>í˜„ì¬ê³ </th>
                <th>í™•ì •ìˆ˜ëŸ‰</th>
                <th>ë¶€ì¡±ìˆ˜ëŸ‰</th>
                <th>ì†Œìš”ì²˜</th>
                <th>ë¦¬ë“œíƒ€ì„(ì¼)</th>
                <th>ë¹„ê³ </th>
                <th>ìƒì„¸</th>
              </tr>
            </thead>
            <tbody>
              <!-- ìƒ˜í”Œ ë°ì´í„° -->
              <tr>
                <td>M001</td>
                <td>ìì¬ A</td>
                <td>ìì¬</td>
                <td>EA</td>
                <td>2025-06-01</td>
                <td>200</td>
                <td>50</td>
                <td>30</td>
                <td>120</td>
                <td>ìƒì‚°ê³„íš #123</td>
                <td>7</td>
                <td>-</td>
                <td>
                  <!-- ìƒì„¸ ë²„íŠ¼ ì˜ˆì‹œ -->
                  <button class="btn btn-info btn-sm"
                    onclick="openMrpDetailModal({
                      item_code: 'M001',
                      item_name: 'ìì¬ A',
                      item_type: 'ìì¬',
                      unit: 'EA',
                      base_date: '2025-06-01',
                      required_qty: 200,
                      stock_qty: 50,
                      confirmed_qty: 30,
                      short_qty: 120,
                      demand_source: 'ìƒì‚°ê³„íš #123',
                      lead_time: 7,
                      note: 'ê¸´ê¸‰êµ¬ë§¤ í•„ìš”'
                    })">ìƒì„¸</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <!-- âœ… ìƒì„¸ ëª¨ë‹¬ì´ ë Œë”ë§ë  ì˜ì—­. ë°˜ë“œì‹œ body ì•ˆì— ìˆì–´ì•¼ í•¨ -->
  <div id="mrpDetailModalWrapper"></div>

  <!-- í‘¸í„° -->
  <div id="footer"></div>

  <!-- âœ… ê³µí†µ ë ˆì´ì•„ì›ƒ/ëª¨ë‹¬ fetch (DOMContentLoaded ì´í›„ ì‹¤í–‰) -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // ê³µí†µ ë ˆì´ì•„ì›ƒ ë¡œë”©
      fetch('/layouts/header.html').then(res => res.text()).then(html => document.getElementById('header').innerHTML = html);
      fetch('/layouts/sidebar.html').then(res => res.text()).then(html => document.getElementById('sidebar').innerHTML = html);
      fetch('/layouts/footer.html').then(res => res.text()).then(html => document.getElementById('footer').innerHTML = html);

      // ìƒì„¸ ëª¨ë‹¬ fetch (í•œ ë²ˆë§Œ)
      fetch('/pages/mrp/mrp-detail-modal.html')
        .then(res => res.text())
        .then(html => {
          document.getElementById('mrpDetailModalWrapper').innerHTML = html;
        });
    });
  </script>
  
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- openMrpDetailModal í•¨ìˆ˜ ë° fetch ëª¨ë‹¬ ì½”ë“œ ë°˜ë“œì‹œ ì•„ë˜ì— ìœ„ì¹˜! -->
  <script>
    // ëª¨ë‹¬ HTML fetch
    fetch('/pages/mrp/mrp-detail-modal.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('mrpDetailModalWrapper').innerHTML = html;
      });

    // [ë°˜ë“œì‹œ ì „ì—­ ë²”ìœ„ì—ì„œ ì„ ì–¸]
    function openMrpDetailModal(data) {
      document.getElementById('mrpDetailItemCode').textContent = data.item_code;
      document.getElementById('mrpDetailItemName').textContent = data.item_name;
      document.getElementById('mrpDetailItemType').textContent = data.item_type;
      document.getElementById('mrpDetailUnit').textContent = data.unit;
      document.getElementById('mrpDetailBaseDate').textContent = data.base_date;
      document.getElementById('mrpDetailRequiredQty').textContent = data.required_qty;
      document.getElementById('mrpDetailStock').textContent = data.stock_qty;
      document.getElementById('mrpDetailConfirmedQty').textContent = data.confirmed_qty;
      document.getElementById('mrpDetailShortQty').textContent = data.short_qty;
      document.getElementById('mrpDetailDemandSource').textContent = data.demand_source;
      document.getElementById('mrpDetailLeadTime').textContent = data.lead_time;
      document.getElementById('mrpDetailNote').textContent = data.note;

      // ëª¨ë‹¬ ë„ìš°ê¸°
      const modal = new bootstrap.Modal(document.getElementById('mrpDetailModal'));
      modal.show();
    }
  </script>
</html>
